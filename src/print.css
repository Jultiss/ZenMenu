/* ====================================
   STYLES D'IMPRESSION - PDF CLEAN
   ==================================== */

@media print {
  /* FORCER LE MODE CLAIR EN IMPRESSION - Override total du dark mode */
  html[data-theme="dark"],
  html[data-theme="dark"] body,
  html[data-theme="dark"] .app,
  html[data-theme="dark"] .app-main,
  html[data-theme="dark"] .page-container,
  html[data-theme="dark"] .plan-hebdo,
  html[data-theme="dark"] .plan-grid,
  html[data-theme="dark"] *:not(.header-cell) {
    background: white !important;
    background-color: white !important;
    color: black !important;
  }

  /* Override des styles dark-mode-fixes.css */
  [data-theme="dark"] .meal-cell,
  [data-theme="dark"] .day-label,
  [data-theme="dark"] .day-cell,
  [data-theme="dark"] .cell {
    background: white !important;
    background-color: white !important;
  }

  /* Forcer day-cell en bleu clair même en dark */
  [data-theme="dark"] .day-cell {
    background: #E8F3FC !important;
    background-color: #E8F3FC !important;
  }

  /* Masquer les éléments non nécessaires */
  .navigation,
  .app-header,
  .theme-toggle,
  .btn-action,
  .btn-save,
  .btn-history,
  .btn-export,
  .header-actions,
  .modal-overlay,
  .modal-note,
  .detail-recette-overlay,
  .consomme-checkbox,
  .btn-consomme,
  .portions-control,
  .btn-portion,
  .btn-change,
  .btn-clear,
  .day-actions {
    display: none !important;
    visibility: hidden !important;
  }

  /* Reset des marges pour maximiser l'espace */
  @page {
    margin: 1.5cm;
    size: A4 portrait;
  }

  * {
    box-shadow: none !important;
  }

  html {
    background: white !important;
  }

  body {
    background: white !important;
    color: black !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  .app {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    background: white !important;
  }

  .app-main {
    padding: 0 !important;
    display: block !important;
    grid-template-columns: 1fr !important;
  }

  .page-container {
    padding: 0 !important;
    background: white !important;
  }

  .page-header {
    display: none !important;
  }

  /* Titre du plan */
  .plan-hebdo {
    display: block !important;
    visibility: visible !important;
  }

  .plan-hebdo h2 {
    color: #2C3E50 !important;
    font-size: 24pt !important;
    margin-bottom: 20pt !important;
    page-break-after: avoid;
    display: block !important;
    visibility: visible !important;
  }

  /* Grille du plan */
  .plan-grid {
    width: 100% !important;
    page-break-inside: avoid;
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
  }

  .grid-header,
  .grid-row {
    display: grid !important;
    grid-template-columns: 80px repeat(4, 1fr) !important;
    gap: 4pt !important;
    page-break-inside: avoid;
    visibility: visible !important;
  }

  .cell {
    border: 1px solid #2C3E50 !important;
    padding: 8pt !important;
    background: white !important;
    min-height: 50px !important;
    page-break-inside: avoid;
    display: flex !important;
    visibility: visible !important;
  }

  .header-cell {
    background: #4A90E2 !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 10pt !important;
    text-align: center !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  .day-cell {
    font-weight: 700 !important;
    font-size: 10pt !important;
    color: #2C3E50 !important;
    background: #E8F3FC !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    visibility: visible !important;
  }

  .day-label {
    font-weight: 700 !important;
    font-size: 10pt !important;
    color: #2C3E50 !important;
    background: #E8F3FC !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .day-name {
    color: #2C3E50 !important;
    visibility: visible !important;
    display: block !important;
  }

  .meal-cell {
    background: white !important;
    border: 1px solid #D1DBE5 !important;
    box-shadow: none !important;
    display: flex !important;
    visibility: visible !important;
  }

  .meal-content {
    gap: 4pt !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    width: 100%;
    visibility: visible !important;
  }

  .meal-name {
    font-size: 9pt !important;
    color: #2C3E50 !important;
    margin: 0 !important;
    font-weight: 600 !important;
    display: block !important;
    visibility: visible !important;
    text-align: center !important;
  }

  .meal-content h4 {
    font-size: 9pt !important;
    color: #2C3E50 !important;
    margin: 0 !important;
    display: block !important;
    visibility: visible !important;
  }

  .meal-content p {
    font-size: 8pt !important;
    color: #5A6C7D !important;
    margin: 0 !important;
    display: block !important;
    visibility: visible !important;
  }

  .meal-type {
    font-size: 7pt !important;
    color: #95A5B8 !important;
    display: block !important;
    visibility: visible !important;
  }

  .meal-portions,
  .portions-text,
  .portions-display,
  .portions-display-print {
    font-size: 7pt !important;
    color: #4A90E2 !important;
    display: block !important;
    visibility: visible !important;
  }

  /* Masquer l'affichage portions normal, montrer celui pour print */
  .portions-display {
    display: none !important;
  }

  .portions-display-print {
    display: block !important;
  }

  .meal-empty {
    font-size: 8pt !important;
    color: #95A5B8 !important;
    font-style: italic !important;
    display: flex !important;
    visibility: visible !important;
    align-items: center !important;
    justify-content: center !important;
  }

  .meal-empty .add-icon {
    display: none !important;
  }

  .meal-empty span:last-child::before {
    content: "—" !important;
  }

  .meal-empty span:last-child {
    font-size: 0 !important;
  }

  .meal-actions {
    display: none !important;
  }

  /* Liste de courses (si présente) */
  .liste-courses {
    page-break-before: always;
  }

  .liste-courses h2 {
    font-size: 20pt !important;
    margin-bottom: 15pt !important;
    color: #2C3E50 !important;
  }

  .categorie-section {
    margin-bottom: 15pt !important;
    page-break-inside: avoid;
  }

  .categorie-nom {
    font-size: 12pt !important;
    font-weight: 700 !important;
    color: #4A90E2 !important;
    margin-bottom: 8pt !important;
    border-bottom: 1px solid #D1DBE5 !important;
    padding-bottom: 4pt !important;
  }

  .ingredient-item {
    font-size: 10pt !important;
    color: #2C3E50 !important;
    padding: 4pt 0 !important;
    border-bottom: 1px dotted #E8EDF2 !important;
  }

  .ingredient-nom {
    font-weight: 600 !important;
  }

  .ingredient-quantite {
    color: #5A6C7D !important;
  }

  /* Footer avec date */
  .print-footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    text-align: center;
    font-size: 8pt;
    color: #95A5B8;
    padding: 10pt 0;
    border-top: 1px solid #E8EDF2;
  }

  /* Forcer les couleurs en impression */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Éviter les sauts de page dans les éléments */
  h2,
  h3,
  h4 {
    page-break-after: avoid;
  }

  .grid-row {
    page-break-inside: avoid;
  }
}

/* Styles pour la preview avant impression */
body.printing-plan .navigation,
body.printing-plan .app-header,
body.printing-plan .btn-action,
body.printing-plan .btn-save,
body.printing-plan .btn-history {
  opacity: 0.3;
  pointer-events: none;
}
