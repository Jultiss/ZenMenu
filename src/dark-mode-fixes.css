/* ====================================
   CORRECTIFS DARK MODE GLOBAUX
   ==================================== */

/* Override des backgrounds blancs codés en dur */
[data-theme="dark"] {
  /* Cartes et conteneurs */
  .recette-card,
  .modal-content,
  .modal-ajout-plan,
  .recherche-ingredients,
  .ingredient-item,
  .preparation-text,
  .sauvegarde-card {
    background: var(--bg-card) !important;
    color: var(--text-primary);
  }

  /* Boutons secondaires */
  .btn-secondary {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-medium) !important;
  }

  .btn-secondary:hover {
    background: var(--bg-card) !important;
    border-color: var(--primary-color) !important;
  }

  /* Boutons clear/reset */
  .btn-clear {
    background: var(--bg-tertiary) !important;
    color: var(--danger-color) !important;
    border-color: var(--danger-color) !important;
  }

  /* Portions badge */
  .portions-badge {
    background: var(--bg-tertiary) !important;
    color: var(--secondary-color) !important;
  }

  /* Meal card actions */
  .meal-card-action {
    background: var(--bg-tertiary) !important;
  }

  /* Select et inputs */
  .filtre-select,
  .search-input-main,
  input[type="text"],
  input[type="number"],
  textarea {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-medium) !important;
  }

  .filtre-select:focus,
  .search-input-main:focus,
  input:focus,
  textarea:focus {
    border-color: var(--primary-color) !important;
    background: var(--bg-card) !important;
  }

  /* Range inputs (sliders) */
  input[type="range"]::-webkit-slider-thumb {
    background: var(--primary-color) !important;
  }

  input[type="range"]::-moz-range-thumb {
    background: var(--primary-color) !important;
  }

  /* Bordures des cartes */
  .recette-card,
  .sauvegarde-card,
  .ingredient-item,
  .preparation-text {
    border-color: var(--border-light) !important;
  }

  .recette-card:hover {
    border-color: var(--primary-color) !important;
    box-shadow: 0 8px 24px rgba(91, 163, 255, 0.2) !important;
  }

  /* Calories badges - garder visibles */
  .recette-card-calories,
  .calories-badge {
    background: var(--gradient-primary) !important;
    color: white !important;
  }

  /* Tags */
  .mini-tag,
  .tag-compatibilite,
  .tag-filtre {
    background: var(--bg-tertiary) !important;
    color: var(--text-secondary) !important;
    border-color: var(--border-medium) !important;
  }

  .tag-filtre.active {
    background: var(--primary-color) !important;
    color: white !important;
  }

  /* Modal overlays */
  .modal-overlay,
  .detail-recette-overlay {
    background: rgba(0, 0, 0, 0.85) !important;
  }

  /* Headers de pages */
  .page-header {
    color: var(--text-primary);
  }

  .page-subtitle {
    color: var(--text-secondary) !important;
  }

  /* Plan hebdo - cellules PLUS SOMBRES */
  .meal-cell {
    background: var(--bg-secondary) !important;
    border-color: var(--border-medium) !important;
  }

  .meal-cell:hover {
    background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--primary-lightest) 100%) !important;
    border-color: var(--primary-color) !important;
  }

  .meal-content h4 {
    color: var(--text-primary) !important;
  }

  .meal-content p {
    color: var(--text-secondary) !important;
  }

  .meal-name {
    color: var(--text-primary) !important;
  }

  .meal-name:hover {
    background-color: rgba(96, 165, 250, 0.15) !important;
  }

  /* Day labels - plus sombres */
  .day-label {
    background: var(--bg-secondary) !important;
    color: var(--text-primary) !important;
    border-right-color: var(--border-medium) !important;
  }

  /* Portions control */
  .portions-control {
    background: rgba(96, 165, 250, 0.12) !important;
  }

  .portions-text {
    color: var(--text-primary) !important;
  }

  /* Bouton consommé */
  .btn-consomme {
    background: var(--bg-tertiary) !important;
    border-color: var(--secondary-color) !important;
    color: var(--secondary-color) !important;
  }

  .btn-consomme.active {
    background: var(--gradient-secondary) !important;
    color: white !important;
  }

  /* Empty states */
  .meal-empty {
    color: var(--text-tertiary) !important;
  }

  /* Grid et plan-grid */
  .plan-grid {
    background: transparent;
  }

  .grid-row {
    background: transparent;
  }

  /* Cell générique */
  .cell {
    background: var(--bg-secondary);
  }

  /* Meal type text */
  .meal-type {
    color: var(--text-tertiary) !important;
  }

  /* Meal card wrapper si existe */
  .meal-card {
    background: var(--bg-secondary) !important;
    border-color: var(--border-medium) !important;
  }

  /* Action buttons dans les meals */
  .meal-card-action {
    background: var(--bg-tertiary) !important;
    color: var(--text-secondary) !important;
  }

  .meal-card-action:hover {
    background: var(--primary-lightest) !important;
    color: var(--primary-color) !important;
  }

  /* Liste de courses */
  .liste-courses {
    background: var(--bg-secondary);
  }

  .categorie-section {
    background: var(--bg-card) !important;
  }

  .categorie-nom {
    color: var(--primary-color) !important;
  }

  .ingredient-nom {
    color: var(--text-primary) !important;
  }

  .ingredient-quantite {
    color: var(--text-secondary) !important;
  }

  /* Historique sauvegardes */
  .historique-modal {
    background: var(--bg-secondary) !important;
  }

  /* Filtres section */
  .filtres-section {
    background: var(--bg-card) !important;
    border-color: var(--border-light) !important;
  }

  /* Footer éléments */
  .detail-footer,
  .modal-footer {
    background: var(--bg-tertiary) !important;
    border-top-color: var(--border-light) !important;
  }

  /* Close buttons */
  .btn-close {
    background: rgba(255, 255, 255, 0.1) !important;
    color: white !important;
  }

  .btn-close:hover {
    background: rgba(255, 255, 255, 0.2) !important;
  }

  /* Meal type labels */
  .meal-type {
    color: var(--text-tertiary) !important;
  }

  /* Portions info */
  .portions-info {
    color: var(--text-secondary) !important;
  }

  /* Grid headers - garder visibles */
  .header-cell {
    background: var(--gradient-primary) !important;
    color: white !important;
  }

  /* Navigation (si pas déjà géré) */
  .navigation {
    background: var(--glass-bg) !important;
    border-top-color: var(--border-medium) !important;
  }

  .nav-link {
    color: var(--text-tertiary) !important;
  }

  .nav-link.active {
    color: var(--primary-color) !important;
    background: var(--primary-lightest) !important;
  }

  /* Checkbox custom */
  .consomme-checkbox:checked {
    background: var(--success-color) !important;
  }

  /* Scrollbars (Webkit) */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--border-medium);
    border-radius: 6px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--border-dark);
  }

  /* Placeholders */
  ::placeholder {
    color: var(--text-muted) !important;
    opacity: 1;
  }

  :-ms-input-placeholder {
    color: var(--text-muted) !important;
  }

  ::-ms-input-placeholder {
    color: var(--text-muted) !important;
  }
}

/* Fix pour les modales qui ont des backgrounds gradient */
[data-theme="dark"] .detail-recette-modal {
  background: var(--bg-secondary) !important;
}

[data-theme="dark"] .detail-header {
  background: var(--gradient-primary) !important;
}

/* Fix pour les éléments avec shadow importantes */
[data-theme="dark"] .recette-card {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6) !important;
}

[data-theme="dark"] .recette-card:hover {
  box-shadow: 0 8px 24px rgba(91, 163, 255, 0.3) !important;
}

/* ====================================
   CORRECTIFS TEXTES HARDCODÉS
   ==================================== */

[data-theme="dark"] {
  /* Titres de pages */
  .page-header h1 {
    color: var(--text-primary) !important;
  }

  /* RecherchePage - titres et sous-titres */
  .recette-card-nom {
    color: var(--text-primary) !important;
  }

  .recette-header h3 {
    color: var(--text-primary) !important;
  }

  /* Textes secondaires gris */
  .ingredients-count,
  .no-results-text,
  .ingredients-preview li {
    color: var(--text-secondary) !important;
  }

  /* Liens et boutons texte */
  .btn-voir-detail {
    color: var(--primary-color) !important;
  }

  .btn-voir-detail:hover {
    color: var(--primary-hover) !important;
  }

  /* Tags */
  .mini-tag {
    background: var(--bg-tertiary) !important;
    color: var(--text-secondary) !important;
  }

  .mini-tag.plus {
    background: var(--bg-tertiary) !important;
    color: var(--text-tertiary) !important;
  }

  /* DetailRecette */
  .detail-titre {
    color: var(--text-primary) !important;
  }

  .section-titre {
    color: var(--text-primary) !important;
  }

  .ingredient-nom {
    color: var(--text-primary) !important;
  }

  .ingredient-quantite {
    color: var(--text-secondary) !important;
  }

  .ingredient-calories {
    color: var(--text-tertiary) !important;
  }

  /* SelecteurRepas */
  .selecteur-titre {
    color: var(--text-primary) !important;
  }

  .type-repas-badge {
    color: var(--primary-color) !important;
  }

  /* Bouton clear - garder rouge mais visible */
  .btn-clear {
    background: var(--bg-tertiary) !important;
    color: var(--danger-color) !important;
    border-color: var(--danger-color) !important;
  }

  .btn-clear:hover {
    background: rgba(239, 68, 68, 0.1) !important;
  }

  /* Input placeholders */
  .input-recherche::placeholder,
  input::placeholder {
    color: var(--text-muted) !important;
  }

  /* Boutons reinitialiser */
  .btn-reinitialiser {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
  }

  .btn-reinitialiser:hover {
    background: var(--bg-card) !important;
  }

  /* Liste ingredients preview */
  .ingredient-item-preview {
    color: var(--text-secondary) !important;
  }

  /* Calories total */
  .calories-total {
    color: var(--text-primary) !important;
  }

  /* Modal overlays - titres */
  .modal-titre,
  .modal-content h2,
  .modal-content h3 {
    color: var(--text-primary) !important;
  }

  /* Labels de formulaire */
  label,
  .form-label {
    color: var(--text-secondary) !important;
  }

  /* Textes d'aide */
  .help-text,
  .hint-text {
    color: var(--text-tertiary) !important;
  }

  /* Liens génériques */
  a {
    color: var(--primary-color) !important;
  }

  a:hover {
    color: var(--primary-hover) !important;
  }

  /* Strong/Bold */
  strong,
  b {
    color: var(--text-primary) !important;
  }

  /* Code blocks si présents */
  code,
  pre {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
  }

  /* Headers de table si présents */
  th {
    color: var(--text-primary) !important;
    background: var(--bg-tertiary) !important;
  }

  td {
    color: var(--text-secondary) !important;
  }

  /* Badges de statut */
  .badge,
  .status-badge {
    color: white !important;
  }

  /* Compteurs et numéros */
  .count,
  .number {
    color: var(--primary-color) !important;
  }

  /* Messages d'erreur */
  .error-message {
    color: var(--danger-color) !important;
  }

  /* Messages de succès */
  .success-message {
    color: var(--success-color) !important;
  }

  /* Messages d'info */
  .info-message {
    color: var(--info-color) !important;
  }

  /* Titres de section */
  h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary) !important;
  }

  /* Paragraphes génériques */
  p {
    color: var(--text-secondary);
  }

  /* Listes */
  li {
    color: var(--text-secondary);
  }

  /* Dividers */
  hr {
    border-color: var(--border-light) !important;
  }

  /* Focus states */
  *:focus {
    outline-color: var(--primary-color) !important;
  }

  /* Selection text */
  ::selection {
    background: var(--primary-color) !important;
    color: white !important;
  }

  ::-moz-selection {
    background: var(--primary-color) !important;
    color: white !important;
  }

  /* Disabled states */
  :disabled,
  [disabled] {
    opacity: 0.5;
    color: var(--text-muted) !important;
  }

  /* PlanPage - éléments spécifiques */
  .plan-hebdo h2 {
    color: var(--text-primary) !important;
  }

  .day-name {
    color: var(--text-primary) !important;
  }

  .meal-type-label {
    color: var(--text-tertiary) !important;
  }

  .meal-portions {
    color: var(--text-secondary) !important;
  }

  /* RecherchePage - modal ajout */
  .modal-ajout-plan h3 {
    color: var(--text-primary) !important;
  }

  .modal-subtitle {
    color: var(--text-secondary) !important;
  }

  /* Checkbox labels */
  .checkbox-label {
    color: var(--text-secondary) !important;
  }

  /* Onglets / Tabs */
  .tab,
  .tab-button {
    color: var(--text-secondary) !important;
  }

  .tab.active,
  .tab-button.active {
    color: var(--primary-color) !important;
  }

  /* Footer items */
  .footer-text {
    color: var(--text-tertiary) !important;
  }

  /* Empty state messages */
  .empty-state h3 {
    color: var(--text-primary) !important;
  }

  .empty-state p {
    color: var(--text-secondary) !important;
  }

  /* Tooltips */
  .tooltip {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
    border-color: var(--border-medium) !important;
  }

  /* Cards generiques */
  .card-title {
    color: var(--text-primary) !important;
  }

  .card-description {
    color: var(--text-secondary) !important;
  }

  .card-footer {
    color: var(--text-tertiary) !important;
  }

  /* Date picker si présent */
  .date-picker {
    background: var(--bg-card) !important;
    color: var(--text-primary) !important;
  }

  /* Dropdown menus */
  .dropdown-menu {
    background: var(--bg-card) !important;
    border-color: var(--border-medium) !important;
  }

  .dropdown-item {
    color: var(--text-primary) !important;
  }

  .dropdown-item:hover {
    background: var(--bg-tertiary) !important;
    color: var(--primary-color) !important;
  }
}
